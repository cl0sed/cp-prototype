# AI Video Creation Platform - Project README

## 1. High-Level Overview

This project is an AI-powered platform designed to drastically reduce pre-production time for educational content creators, specifically targeting "Accelerating Creators" (often with 25K-50K subscribers) who face bottlenecks in research and scripting.

**Core Value Proposition:**

* **90% Pre-production Time Reduction:** Automate significant portions of research, structuring, and scripting.
* **Creator Voice Preservation:** Maintain the creator's unique linguistic style and authenticity using "Creator DNA" technology.
* **Sustainable Scaling:** Enable creators to increase content output without burnout.

The platform guides creators through a pre-production pipeline, leveraging AI for heavy lifting while keeping the creator in control of key decisions. The primary user interaction model is conversational, driven by AI agents orchestrated via the Haystack framework.

## 2. Project Structure (Monorepo)

This project uses a monorepo structure to manage the frontend, backend (API & Worker), and related configurations together. This simplifies local development and dependency management while maintaining clear separation for potential future splitting.

```
your-project-root/
├── .github/                  # CI/CD Automation (e.g., GitHub Actions)
│   └── workflows/
│       ├── ci-backend.yml
│       └── ci-frontend.yml
│       └── deploy-staging.yml # Example deployment workflow
│       └── deploy-production.yml # Example deployment workflow
├── .gitignore                # Files/folders for Git to ignore
├── docker-compose.yml        # Local development environment setup
├── .env.example              # --- KEY: Example env vars for LOCAL development ---
├── .env.staging.example      # --- KEY: Example env vars for STAGING environment ---
├── .env.production.example   # --- KEY: Example env vars for PRODUCTION (excluding secrets!) ---
├── README.md                 # --- KEY: High-level overview, Arch decisions, Setup, How to Run ---
│
├── backend/
│   ├── app/
│   │   ├── __init__.py
│   │   ├── main.py           # FastAPI app definition, middleware, lifespan events
│   │   ├── config.py         # --- KEY: Pydantic settings loading from ENV variables ---
│   │   ├── logging_config.py # --- KEY ADDITION: Configure application logging (levels, formats) ---
│   │   │
│   │   ├── api/              # FastAPI specifics
│   │   │   ├── __init__.py
│   │   │   ├── dependencies.py # Auth checks, DB sessions per request
│   │   │   ├── middleware/   # Custom middleware (e.g., request timing)
│   │   │   │   └── ...
│   │   │   ├── routers/      # Endpoint definitions, grouped by feature
│   │   │   │   └── ...
│   │   │   └── schemas.py    # API request/response data shapes (Pydantic)
│   │   │
│   │   ├── worker/           # SAQ Worker specifics
│   │   │   ├── __init__.py
│   │   │   └── settings.py   # SAQ Queue definition, task imports/discovery
│   │   │
│   │   ├── db/               # Database specifics
│   │   │   ├── __init__.py
│   │   │   ├── models.py     # SQLAlchemy table definitions
│   │   │   ├── migrations/   # --- KEY: Alembic DB schema change scripts ---
│   │   │   │   └── versions/
│   │   │   │       └── ...py # Individual migration files generated by Alembic
│   │   │   │   └── env.py    # Alembic runtime environment
│   │   │   │   └── script.py.mako # Migration file template
│   │   │   └── session.py    # DB connection/session logic
│   │   │
│   │   ├── shared/           # Code shared across backend features
│   │   │   ├── __init__.py
│   │   │   ├── clients/      # Clients for 3rd party APIs (YouTube, etc.)
│   │   │   │   └── ...
│   │   │   ├── constants.py  # Shared Enums and constant values
│   │   │   ├── exceptions.py # Custom error classes
│   │   │   ├── schemas.py    # Core internal data shapes (Pydantic)
│   │   │   └── utils.py      # Common helper functions
│   │   │
│   │   └── features/         # Business Logic / Domain Features
│   │       ├── __init__.py
│   │       │
│   │       ├── auth/         # Example user/auth feature logic
│   │       │   └── ...
│   │       │
│   │       ├── voice_dna/    # Example Creator DNA feature logic
│   │       │   ├── __init__.py
│   │       │   ├── pipelines.py  # Haystack/AI pipeline definitions
│   │       │   ├── prompts/      # Prompt templates
│   │       │   ├── service.py    # Core logic / Facade for this feature
│   │       │   └── tasks.py      # Background tasks for this feature
│   │       │
│   │       └── # ... (research/, scripting/, etc.)
│   │
│   ├── tests/                # Backend automated tests
│   │   ├── __init__.py
│   │   └── # (Mirror app structure: api/, features/, shared/, etc.)
│   │
│   ├── models/               # --- KEY ADDITION (Optional): For downloaded AI models (if self-hosting later) ---
│   │   └── .gitkeep
│   │
│   ├── Dockerfile            # Builds the common backend image (API + Worker code)
│   ├── pyproject.toml        # Python dependencies (Poetry/PDM)
│   ├── alembic.ini           # Alembic configuration file
│   ├── ruff.toml             # --- KEY ADDITION: Example Linter/Formatter config ---
│   └── README.md             # --- KEY: Backend setup, running locally, migration cmd, testing cmd ---
│
├── frontend/
│   ├── src/                  # SvelteKit source code
│   │   ├── app.html
│   │   ├── app.d.ts
│   │   ├── app.css           # Global styles
│   │   ├── hooks.server.js   # Server-side hooks
│   │   ├── hooks.client.js   # Client-side hooks
│   │   │
│   │   ├── lib/              # Reusable frontend modules
│   │   │   ├── components/   # UI Components
│   │   │   ├── services/     # API Client (handles requests/responses/errors)
│   │   │   ├── stores/       # Global state management
│   │   │   ├── types/        # TypeScript definitions
│   │   │   └── utils/        # Helper functions
│   │   │
│   │   └── routes/           # Application pages and layouts
│   │       └── ...
│   │
│   ├── static/               # Static assets (favicon, images)
│   ├── tests/                # Frontend automated tests
│   ├── Dockerfile            # --- KEY: Builds PRODUCTION frontend image (often serves static files via Nginx) ---
│   ├── package.json          # Node.js dependencies
│   ├── svelte.config.js
│   ├── vite.config.js
│   ├── .prettierrc.json      # --- KEY ADDITION: Example Formatter config ---
│   ├── .eslintrc.cjs         # --- KEY ADDITION: Example Linter config ---
│   └── README.md             # --- KEY: Frontend setup, running dev server, building for prod ---
│
├── e2e_tests/                # --- KEY ADDITION (Optional): End-to-end tests (e.g., Playwright/Cypress) ---
│   └── .gitkeep
│
├── infra/                    # Optional: Infrastructure-as-Code (Terraform, Pulumi)
│   └── .gitkeep
│
└── scripts/                  # Optional: Helper scripts (e.g., db reset, run linters)
    └── .gitkeep
```

* **`backend/`:** Contains all Python code for the API (FastAPI) and background tasks (SAQ Worker). It's structured internally by features (`backend/app/features/`). See `backend/README.md`.
* **`frontend/`:** Contains the SvelteKit user interface code. See `frontend/README.md`.
* **Root:** Contains shared configurations, local development setup (`docker-compose.yml`), CI/CD workflows, and this main README.

## 3. Key Architecture Decisions

The architecture prioritizes developer velocity (as a solopreneur), low operational overhead ("Low-Ops"), scalability, and creator voice authenticity. Key choices include:

* **Language/Framework:** Python with FastAPI (Backend), Svelte/SvelteKit (Frontend).
* **AI Orchestration:** Haystack Framework (v2+) for building AI pipelines and agents.
* **Database:** Managed PostgreSQL with the `pgvector` extension for relational and vector data storage. Alembic is used for database migrations.
* **Background Tasks:** SAQ (Simple Async Queue) with a Managed Redis backend for asynchronous job processing.
* **Hosting:** Container-based PaaS (e.g., Google Cloud Run, AWS App Runner, Render) for simplified deployment and scaling.
* **Backend Deployment Strategy:** A **single backend Docker image** is built containing code for both the API and Worker. Separate container instances are run from this image using different entry commands (Uvicorn for API, SAQ for Worker) specified in the deployment configuration (e.g., `docker-compose.yml`). This ensures consistency and simplifies the build process.
* **Observability:** OpenTelemetry for instrumentation, exporting data to a managed stack (planned: Grafana Cloud for Infra/Logs/Traces, Sentry for App Errors/APM, PostHog for Product Analytics). LLM interactions monitored via an LLM Gateway (e.g., Portkey).
* **Design Patterns:** Async-first design, Dependency Injection (via FastAPI).
* **Development:** Docker Compose for managing local development services (Postgres, Redis, API, Worker, Frontend). Code quality enforced via pre-commit hooks and linters/formatters.

*(Refer to `Architecture Decisions Summary (Markdown).pdf` [cite: 1, 2, 3, 4, 5, 6, 7] for more detailed justifications)*

## 4. Local Development Setup & Running

This provides a very brief overview. **See `backend/README.md` and `frontend/README.md` for detailed setup, testing, and command instructions.**

**Prerequisites:**

* Docker & Docker Compose
* Git
* Python environment management (e.g., Poetry or PDM) - for backend tools/hooks
* Node.js & package manager (npm/yarn/pnpm) - for frontend tools/hooks

**Basic Steps:**

1.  **Clone the repository:**
    ```bash
    git clone <repository-url>
    cd <repository-directory>
    ```
2.  **Configure Environment:**
    * Copy `.env.example` to `.env`.
    * Fill in necessary local configuration values in `.env` (database credentials, placeholders for API keys, etc.). **CRITICAL: Never commit your actual `.env` file to Git!**
3.  **Build & Start Services:**
    ```bash
    docker-compose up --build -d
    ```
    * This command builds the Docker images (if they don't exist or Dockerfiles changed) and starts all services defined in `docker-compose.yml` (db, redis, api, worker, frontend) in the background.
4.  **Access Services (Default Ports):**
    * Frontend: `http://localhost:5173`
    * Backend API: `http://localhost:8000`
5.  **Database Migrations:**
    * **CRITICAL:** If you pull changes that include database schema modifications (`backend/db/migrations/`), you MUST apply them *before* running the application code that depends on them.
    * Run the migration command (detailed in `backend/README.md`), typically:
        ```bash
        docker-compose exec backend alembic upgrade head
        ```
6.  **Stopping Services:**
    ```bash
    docker-compose down
    ```

**Important Considerations:**

* **Configuration:** Local development uses `.env`. Staging and Production environments load configuration from environment variables (set via PaaS interface or IaC) which are read by `backend/app/config.py`.
* **Secrets Management:** **CRITICAL:** For Staging/Production, sensitive data (API keys, database passwords) **MUST** be stored securely using a secrets management system (e.g., AWS Secrets Manager, Google Secret Manager, HashiCorp Vault) and injected as environment variables at runtime, *not* stored in `.env` files or code.
* **Logging:** Application logging behaviour (levels, formats) is configured in `backend/app/logging_config.py`. Check container logs via `docker-compose logs <service_name>`. Basic logging will be supplemented by Sentry and Grafana Cloud post-PoC[cite: 5, 90, 95].
* **Error Handling:** Backend errors are caught and transformed into standard API error responses. The frontend's API client (`frontend/src/lib/services/apiClient.js`) should handle these responses gracefully. Sentry (once integrated) will track backend exceptions[cite: 5].
* **Frontend Build:** The local dev server (`npm run dev`) provides hot reloading. For production, the `frontend/Dockerfile` typically creates an optimized static build served efficiently (e.g., via Nginx or PaaS static hosting).

*(Refer to the README files inside the `backend/` and `frontend/` directories for detailed development workflows.)*
